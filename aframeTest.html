<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>A-Frame Example</title>
    <style>
        body {
            margin: 0;
        }

        canvas {
            display: block;
        }
    </style>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
    <script>
        AFRAME.registerComponent('log-when-loaded', {
            init: function () {
                console.log('Component has been loaded');
                cameraEL = document.querySelector('a-camera')
                cameraEL.removeAttribute('look-controls')
                camera = cameraEL.components.camera.camera
                camera.fov = 75
                camera.far = 1000
                camera.near = 1
                camera.position.z = 5
         
                
                window.addEventListener('resize', onWindowResize, false);
                scene = document.querySelector('a-scene')
                renderer = scene.renderer
                setTimeout(() => {
                    updateCubePosition()
                }, 1);
               
            
            }
        });
    </script>
</head>

<body>
    <a-scene log-when-loaded="">
        <a-camera  position="0 0 0"></a-camera>
        <a-box id="cube" position="0 0 -5" color="#4CC3D9"></a-box>
    </a-scene>

    <script>
        // const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        let cameraEL = document.querySelector('a-camera')
        let camera
        // const camera = cameraEL.el.components.camera.camera 
        // console.log(camera)
        // camera.far = 1000
        // camera.fov = 75

        // console.log(camera)
        let scene 

        let renderer 

        // let camera = cameraEL.components.camera.camera






        // Function to handle window resize
        function onWindowResize() {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
            updateCubePosition();
        }


        const cube = document.querySelector('#cube');


        function updateCubePosition() {

            console.log('Window inner height:', window.innerHeight);
            console.log('Window inner width:', window.innerWidth);
            const vh = window.innerHeight / 100;
            const vw = window.innerWidth / 100;

            const targetY = 20 * vh; // 20vh in pixels
            const targetX = 20 * vw; // 50vw in pixels
            console.log(vh, vw);


            const ndcY = (targetY / window.innerHeight) * 2 - 1; // Convert to NDC
            const ndcX = (targetX / window.innerWidth) * 2 - 1; // Convert to NDC

            const vec = new THREE.Vector3(ndcX, ndcY, 0.5); // NDC coordinates
            console.log("vec", vec);
            const pos = new THREE.Vector3();

            console.log("camera position", camera.position);
            vec.unproject(camera);
            console.log("unprojected vec", vec);
            vec.sub(camera.position).normalize();
            console.log("subbed", vec);
            console.log("camera", camera.position)
            const distance = -camera.position.z / vec.z;

            console.log('Camera position:', camera.position);
            console.log('Initial vec:', vec);
            console.log('Distance:', distance);

            // Perform the operation
            pos.copy(camera.position).add(vec.multiplyScalar(distance));

            // Debugging: Log resulting vector
            console.log('Resulting pos:', pos);

            // cube.position.copy(pos);
            cube.setAttribute('position', pos);

        }

        // updateCubePosition()

        // Initial update of the cube's position
    </script>
</body>

</html>